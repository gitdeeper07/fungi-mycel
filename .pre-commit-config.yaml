# FUNGI-MYCEL Pre-commit Configuration
# Framework for Mycelial Network Intelligence Assessment

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        name: Clean trailing whitespace
      - id: end-of-file-fixer
        name: Ensure EOF newline
      - id: check-yaml
        name: Validate YAML syntax
        args: [--allow-multiple-documents]
      - id: check-json
        name: Validate JSON syntax
      - id: check-toml
        name: Validate TOML syntax
      - id: check-added-large-files
        name: Prevent large files
        args: [--maxkb=10240]  # 10MB limit for MNU datasets
      - id: check-merge-conflict
        name: Check for merge conflicts
      - id: detect-private-key
        name: Detect private keys
      - id: check-case-conflict
        name: Check case conflicts

  - repo: https://github.com/psf/black
    rev: 24.1.0
    hooks:
      - id: black
        name: Format Python code (Black)
        language_version: python3
        args: [--line-length=88, --target-version=py310]

  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        name: Sort imports (isort)
        args: ["--profile", "black", "--line-length=88"]

  - repo: https://github.com/pycqa/flake8
    rev: 7.0.0
    hooks:
      - id: flake8
        name: Lint Python code (Flake8)
        args: [
          "--max-line-length=88",
          "--extend-ignore=E203,W503",
          "--exclude=.git,__pycache__,docs/source/conf.py,old,build,dist"
        ]

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.8.0
    hooks:
      - id: mypy
        name: Type check Python (MyPy)
        additional_dependencies: [
          "types-all",
          "numpy",
          "pandas",
          "scipy"
        ]
        args: [
          "--ignore-missing-imports",
          "--strict-optional",
          "--warn-unused-ignores"
        ]

  - repo: https://github.com/PyCQA/bandit
    rev: 1.7.7
    hooks:
      - id: bandit
        name: Security linting (Bandit)
        args: ["-c", "pyproject.toml", "-r", "fungi_mycel"]
        additional_dependencies: ["bandit[toml]"]

  - repo: https://github.com/kynan/nbstripout
    rev: 0.7.1
    hooks:
      - id: nbstripout
        name: Clean Jupyter notebooks

  - repo: local
    hooks:
      - id: validate-mnis-params
        name: Validate MNIS parameters
        entry: python scripts/validate_parameters.py
        language: system
        files: ^fungi_mycel/parameters/.*\.py$
        pass_filenames: false
        
      - id: check-rho-e-ktopo-correlation
        name: Check œÅ_e-K_topo correlation
        entry: python scripts/check_correlation.py --expected 0.917
        language: system
        files: ^data/bioelectrical/.*\.csv$|^data/hyphal_morphology/.*\.csv$
        pass_filenames: false

  - repo: https://github.com/terrencepreilly/darglint
    rev: v1.8.1
    hooks:
      - id: darglint
        name: Validate docstrings
        args: [
          "--docstring-style", "google",
          "--strictness", "short"
        ]

  - repo: https://github.com/nbQA-dev/nbQA
    rev: 1.7.0
    hooks:
      - id: nbqa-black
        name: Black for notebooks
        args: [--nbqa-mutate]
      - id: nbqa-isort
        name: isort for notebooks
        args: [--nbqa-mutate, --profile=black]
      - id: nbqa-flake8
        name: Flake8 for notebooks

  - repo: https://github.com/asottile/pyupgrade
    rev: v3.15.0
    hooks:
      - id: pyupgrade
        name: Upgrade Python syntax
        args: [--py310-plus]

  - repo: https://github.com/MarcoGorelli/absolufy-imports
    rev: v0.3.1
    hooks:
      - id: absolufy-imports
        name: Absolute imports
        files: ^fungi_mycel/

  - repo: https://github.com/python-poetry/poetry
    rev: 1.7.0
    hooks:
      - id: poetry-check
        name: Check poetry config
      - id: poetry-lock
        name: Check poetry lock
        args: ["--check"]
